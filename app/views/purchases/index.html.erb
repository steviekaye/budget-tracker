<h1 class="title">Purchases</h1>

<div class="card">
  <div class="card-content">
    <%= render 'form' %>
  </div>
</div>

<br>

<div class='purchase-index'>

  <% if @purchases&.any? %>
    <table class="table is-bordered is-striped is-hidden-mobile">
      <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Amount</th>
          <th>Payee</th>
          <th>Category</th>
          <th>Purchaser</th>
          <th>Purchasee</th>
        </tr>
      </thead>
      <tbody>
        <% if @purchases %>
          <% @purchases.order(:date).reverse_order.each do |purchase| %>
            <tr>
              <td><%= purchase.date.to_s %></td>
              <td><%= purchase.description %></td>
              <td><%= number_to_currency(purchase.amount) %></td>
              <td><%= purchase.payee %></td>
              <td><%= Subcategory.find(purchase[:subcategory_id]).name %></td>
              <td><%= User.find(purchase[:purchaser_id]).name %></td>
              <td><%= User.find(purchase[:purchasee_id]).name %></td>
            </tr>
          <% end %>
        <% end %>

      </tbody>
    </table>
  <% end %>

  <!-- write custom div class with flex -->
  <div class="level is-hidden-tablet">
    <% if @purchases %>
      <% @purchases.each do |purchase| %>

        <div class="mobile-table-equiv">
          <div class="mobile-table-equiv-element has-text-weight-bold">
            <div>
              <%= purchase.description %>
            </div>
            <div>
              <%= number_to_currency(purchase.amount) %>
            </div>
          </div>
          <div class="mobile-table-equiv-element">
            <div>
              <%= purchase.payee %>
            </div>
            <div>
              <%= purchase.date.to_s %>
            </div>
          </div>
          <div class="mobile-table-equiv-element">
            <div>
              <%= User.find(purchase[:purchaser_id]).name %>
            </div>
            <div>
              <%= Subcategory.find(purchase[:subcategory_id]).name %>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>